<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NodeJS-MySQL App</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Product Details</h1>
    <div>
        <form id="form" style="margin-bottom: 10px;">
            <label for="product_model">Product Model:</label>
            <input type="text" id="product_model" name="product_model" required>
            <input type="submit" value="Submit">
        </form>

        <table border="1">
            <thead>
                <tr>
                    <th>Product ID</th>
                    <th>Product Model</th>
                    <th>Product Type</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

    <script>
        function submit(event) {
            event.preventDefault();
            const modelInput = document.getElementById('product_model');
            const typeInput = document.getElementById('product_type');
            const table = document.getElementsByTagName('tbody')[0];

            const xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (xhr.readyState === XMLHttpRequest.DONE) {
                    const response = JSON.parse(xhr.responseText);

                    // Remove the existing rows
                    for (let i = table.rows.length - 1; i > -1; i--) {
                        table.deleteRow(i);
                    }

                    // Loop through the response and update the table
                    for (let i = 0; i < response.length; i++) {
                        const product_id = response[i].product_id;
                        const product_model = response[i].product_model;
                        const product_type = response[i].product_type;

                        const table = document.getElementsByTagName('tbody')[0];
                        const newRow = table.insertRow(table.length);
                        const cell1 = newRow.insertCell(0);
                        const cell2 = newRow.insertCell(1);
                        const cell3 = newRow.insertCell(2);

                        cell1.innerHTML = product_id;
                        cell2.innerHTML = product_model;
                        cell3.innerHTML = product_type;
                    }
                }
            };
            const product_model = document.getElementById('product_model').value;
            xhr.open('POST', `/api/v1/getProductDetails?model=${product_model}`, true);
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.send();
        }

        document.getElementById("form").addEventListener("submit", submit);
    </script>
</body>
</html>